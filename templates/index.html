<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu Planner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-left">
                    <img src="{{ url_for('static', filename='images/logo white.png') }}" alt="Zest Logo" class="header-logo">
                    <div class="header-text">
                        <h1>Menu Planner</h1>
                        <p class="subtitle">Generate weekly meal plans and shopping lists</p>
                    </div>
                </div>
                <a href="/recipes" class="btn-secondary">üìö My Recipes</a>
            </div>
        </header>

        <div class="form-section">
            <form id="planForm">
                <div class="form-group">
                    <label for="household_size">üë• Household Size</label>
                    <input type="number" id="household_size" name="household_size" min="1" value="2" required>
                </div>

                <div class="form-group">
                    <label for="nights">üìÖ Number of Nights (1-7)</label>
                    <input type="number" id="nights" name="nights" min="1" max="7" value="3" required>
                </div>

                <div class="form-group">
                    <label for="cooking_time_preference">‚è±Ô∏è Cooking Time Preference</label>
                    <select id="cooking_time_preference" name="cooking_time_preference" required>
                        <option value="mixed">Mixed</option>
                        <option value="quick">Quick (‚â§30 min)</option>
                        <option value="long">Long (>30 min)</option>
                    </select>
                </div>

                <div class="form-divider"></div>

                <!-- Recipe Selection Section (Inline) -->
                <div class="import-section-inline">
                    <label class="import-label">üçΩÔ∏è Add Specific Recipes (Optional)</label>
                    <p class="help-text">Choose recipes from your library or import from the web</p>

                    <!-- Tab Navigation -->
                    <div class="recipe-tabs">
                        <button type="button" class="recipe-tab active" id="myRecipesTab">üìö My Recipes</button>
                        <button type="button" class="recipe-tab" id="importUrlTab">üåê Import from URL</button>
                        <button type="button" class="recipe-tab" id="aiAssistantTab">ü§ñ AI Assistant</button>
                    </div>

                    <!-- Option 1: My Recipes -->
                    <div id="myRecipesSection" class="recipe-option-section">
                        <div class="my-recipes-dropdown-container">
                            <select id="myRecipesDropdown" class="my-recipes-dropdown" size="6" multiple>
                                <option value="" disabled>Loading recipes...</option>
                            </select>
                            <button type="button" id="addFromLibraryBtn" class="btn-secondary btn-small">+ Add Selected</button>
                        </div>
                        <p class="help-text-small">Hold Ctrl (Cmd on Mac) to select multiple recipes</p>
                    </div>

                    <!-- Option 2: Import from URL -->
                    <div id="importUrlSection" class="recipe-option-section hidden">
                        <div class="url-input-group">
                            <input type="url" id="recipeUrl" placeholder="https://example.com/recipe" class="url-input">
                            <button type="button" id="importBtn" class="btn-secondary">+ Import</button>
                        </div>
                        <p class="supported-sites-small">‚úì Supports 500+ sites including AllRecipes, BBC Good Food, Food Network, Serious Eats</p>
                    </div>

                    <!-- Option 3: AI Assistant -->
                    <div id="aiAssistantSection" class="recipe-option-section hidden">
                        <p class="help-text-small" style="margin-bottom: 15px;">Chat with AI to find BBC Good Food recipes that match your preferences</p>

                        <div id="chatMessages" class="chat-messages">
                            <div class="chat-message ai-message">
                                <strong>AI Assistant:</strong> Hi! I'm here to help you find recipes from BBC Good Food. What are you in the mood for? Tell me about your preferences (quick meals, specific ingredients, cuisine type, etc.) and I'll suggest some recipes!
                            </div>
                        </div>

                        <div class="chat-input-container">
                            <input type="text" id="aiChatInput" placeholder="E.g., 'I want something quick with chicken'" class="chat-input">
                            <button type="button" id="aiChatSend" class="btn-secondary">Send</button>
                        </div>

                        <div id="aiSuggestedRecipes" class="ai-suggested-recipes"></div>
                    </div>

                    <!-- Selected Recipes Chips -->
                    <div id="importedRecipes" class="imported-recipes-chips"></div>
                </div>

                <button type="submit" class="btn-primary">Generate Meal Plan</button>
            </form>
        </div>

        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <p>Generating your meal plan...</p>
        </div>

        <div id="warnings" class="warnings hidden"></div>

        <div id="results" class="results hidden">
            <section id="menuSection" class="menu-section">
                <h2>Your Weekly Menu</h2>
                <div id="menuContent"></div>
            </section>

            <section id="shoppingSection" class="shopping-section">
                <h2>Shopping List</h2>
                <div id="shoppingContent"></div>
            </section>
        </div>

        <!-- Save Imported Recipes Modal -->
        <div id="saveRecipesModal" class="modal hidden">
            <div class="modal-content">
                <h3>üíæ Save Imported Recipes?</h3>
                <p class="modal-description">Which recipes should we save permanently for future meal plans?</p>

                <div id="saveRecipesList" class="save-recipes-list">
                    <!-- Checkboxes will be inserted here by JavaScript -->
                </div>

                <div class="modal-buttons">
                    <button id="saveRecipesSubmit" class="btn-primary">Save Selected</button>
                    <button id="saveRecipesSkip" class="btn-secondary">Don't Save</button>
                </div>
            </div>
        </div>

        <footer>
            <p>Plan saved to <code>last_plan.json</code></p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>


